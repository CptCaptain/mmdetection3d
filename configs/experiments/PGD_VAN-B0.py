data = {'val': {'type': 'NuScenesMonoDataset', 'classes': ['car', 'truck', 'trailer', 'bus', 'construction_vehicle', 'bicycle', 'motorcycle', 'pedestrian', 'traffic_cone', 'barrier'], 'ann_file': 'data/nuscenes/nuscenes_infos_val_mono3d.coco.json', 'modality': {'use_map': False, 'use_lidar': False, 'use_radar': False, 'use_camera': True, 'use_external': False}, 'pipeline': [{'type': 'LoadImageFromFileMono3D'}, {'flip': False, 'type': 'MultiScaleFlipAug', 'transforms': [{'type': 'RandomFlip3D'}, {'std': [1, 1, 1], 'mean': [103.53, 116.28, 123.675], 'type': 'Normalize', 'to_rgb': False}, {'type': 'Pad', 'size_divisor': 32}, {'type': 'DefaultFormatBundle3D', 'with_label': False, 'class_names': ['car', 'truck', 'trailer', 'bus', 'construction_vehicle', 'bicycle', 'motorcycle', 'pedestrian', 'traffic_cone', 'barrier']}, {'keys': ['img'], 'type': 'Collect3D'}], 'scale_factor': 1}], 'data_root': 'data/nuscenes/', 'test_mode': True, 'img_prefix': 'data/nuscenes/', 'box_type_3d': 'Camera'}, 'test': {'type': 'NuScenesMonoDataset', 'classes': ['car', 'truck', 'trailer', 'bus', 'construction_vehicle', 'bicycle', 'motorcycle', 'pedestrian', 'traffic_cone', 'barrier'], 'ann_file': 'data/nuscenes/nuscenes_infos_val_mono3d.coco.json', 'modality': {'use_map': False, 'use_lidar': False, 'use_radar': False, 'use_camera': True, 'use_external': False}, 'pipeline': [{'type': 'LoadImageFromFileMono3D'}, {'flip': False, 'type': 'MultiScaleFlipAug', 'transforms': [{'type': 'RandomFlip3D'}, {'std': [1, 1, 1], 'mean': [103.53, 116.28, 123.675], 'type': 'Normalize', 'to_rgb': False}, {'type': 'Pad', 'size_divisor': 32}, {'type': 'DefaultFormatBundle3D', 'with_label': False, 'class_names': ['car', 'truck', 'trailer', 'bus', 'construction_vehicle', 'bicycle', 'motorcycle', 'pedestrian', 'traffic_cone', 'barrier']}, {'keys': ['img'], 'type': 'Collect3D'}], 'scale_factor': 1}], 'data_root': 'data/nuscenes/', 'test_mode': True, 'img_prefix': 'data/nuscenes/', 'box_type_3d': 'Camera'}, 'train': {'type': 'NuScenesMonoDataset', 'classes': ['car', 'truck', 'trailer', 'bus', 'construction_vehicle', 'bicycle', 'motorcycle', 'pedestrian', 'traffic_cone', 'barrier'], 'ann_file': 'data/nuscenes/nuscenes_infos_train_mono3d.coco.json', 'modality': {'use_map': False, 'use_lidar': False, 'use_radar': False, 'use_camera': True, 'use_external': False}, 'pipeline': [{'type': 'LoadImageFromFileMono3D'}, {'type': 'LoadAnnotations3D', 'with_bbox': True, 'with_label': True, 'with_bbox_3d': True, 'with_label_3d': True, 'with_attr_label': True, 'with_bbox_depth': True}, {'type': 'Resize', 'img_scale': [(1600, 900)], 'keep_ratio': True}, {'type': 'RandomFlip3D', 'flip_ratio_bev_horizontal': 0.5}, {'std': [1, 1, 1], 'mean': [103.53, 116.28, 123.675], 'type': 'Normalize', 'to_rgb': False}, {'type': 'Pad', 'size_divisor': 32}, {'type': 'DefaultFormatBundle3D', 'class_names': ['car', 'truck', 'trailer', 'bus', 'construction_vehicle', 'bicycle', 'motorcycle', 'pedestrian', 'traffic_cone', 'barrier']}, {'keys': ['img', 'gt_bboxes', 'gt_labels', 'attr_labels', 'gt_bboxes_3d', 'gt_labels_3d', 'centers2d', 'depths'], 'type': 'Collect3D'}], 'data_root': 'data/nuscenes/', 'test_mode': False, 'img_prefix': 'data/nuscenes/', 'box_type_3d': 'Camera'}, 'samples_per_gpu': 2, 'workers_per_gpu': 2}
dims = [32, 64, 160, 256]
model = {'neck': {'type': 'FPN', 'num_outs': 5, 'in_channels': [32, 64, 160, 256], 'start_level': 1, 'out_channels': 256, 'add_extra_convs': 'on_output', 'relu_before_extra_convs': True}, 'type': 'FCOSMono3D', 'backbone': {'arch': 'b0', 'type': 'VAN', 'init_cfg': {'type': 'Pretrained', 'checkpoint': '/home/nils/VAN-Detection/models/van_tiny_754.pth.tar'}, 'out_indices': [0, 1, 2, 3], 'drop_path_rate': 0.1}, 'test_cfg': {'nms_pre': 1000, 'nms_thr': 0.8, 'score_thr': 0.01, 'max_per_img': 200, 'min_bbox_size': 0, 'use_rotate_nms': True, 'nms_across_levels': False}, 'bbox_head': {'type': 'PGDHead', 'strides': [8, 16, 32, 64, 128], 'division': 'uniform', 'loss_cls': {'type': 'FocalLoss', 'alpha': 0.25, 'gamma': 2, 'loss_weight': 1, 'use_sigmoid': True}, 'loss_dir': {'type': 'CrossEntropyLoss', 'loss_weight': 1, 'use_sigmoid': False}, 'conv_bias': True, 'loss_attr': {'type': 'CrossEntropyLoss', 'loss_weight': 1, 'use_sigmoid': False}, 'loss_bbox': {'beta': 0.1111111111111111, 'type': 'SmoothL1Loss', 'loss_weight': 1}, 'pred_velo': True, 'bbox_coder': {'type': 'PGDBBoxCoder', 'base_dims': [[4.62, 1.73, 1.96], [6.93, 2.83, 2.51], [12.56, 3.89, 2.94], [11.22, 3.5, 2.95], [6.68, 3.21, 2.85], [6.68, 3.21, 2.85], [2.11, 1.46, 0.78], [0.73, 1.77, 0.67], [0.41, 1.08, 0.41], [0.5, 0.99, 2.52]], 'code_size': 9, 'base_depths': [[31.99, 21.12], [37.15, 24.63], [39.69, 23.97], [40.91, 26.34], [34.16, 20.11], [22.35, 13.7], [24.28, 16.05], [27.26, 15.5], [20.61, 13.68], [22.74, 15.01]]}, 'cls_branch': [256], 'depth_bins': 6, 'depth_unit': 10, 'dir_branch': [256], 'dir_offset': 0.7854, 'loss_depth': {'beta': 0.1111111111111111, 'type': 'SmoothL1Loss', 'loss_weight': 1}, 'pred_attrs': True, 'reg_branch': [[256], [256], [256], [256], [], [256]], 'attr_branch': [256], 'depth_range': [0, 50], 'in_channels': 256, 'num_classes': 10, 'pred_bbox2d': True, 'depth_branch': [256], 'norm_on_bbox': True, 'feat_channels': 256, 'stacked_convs': 2, 'group_reg_dims': [2, 1, 3, 1, 2, 4], 'pred_keypoints': False, 'center_sampling': True, 'diff_rad_by_sin': True, 'loss_centerness': {'type': 'CrossEntropyLoss', 'loss_weight': 1, 'use_sigmoid': True}, 'dcn_on_last_conv': True, 'centerness_on_reg': True, 'use_depth_classifier': True, 'use_direction_classifier': True}, 'train_cfg': {'debug': False, 'pos_weight': -1, 'code_weight': [1, 1, 0.2, 1, 1, 1, 1, 0.05, 0.05, 0.2, 0.2, 0.2, 0.2], 'allowed_border': 0}}
runner = {'type': 'EpochBasedRunner', 'max_epochs': 12}
gpu_ids = [0]
norm_cfg = {'type': 'SyncBN', 'requires_grad': False}
work_dir = './work_dirs/pgd_van_caffe_fpn_gn-head_2x16_1x_nus-mono3d'
workflow = [['train', 4], ['val', 1]]
data_root = 'data/nuscenes/'
load_from = None
log_level = 'INFO'
lr_config = {'step': [8, 11], 'policy': 'step', 'warmup': 'linear', 'warmup_iters': 500, 'warmup_ratio': 1}
optimizer = {'lr': 0.004, 'type': 'SGD', 'momentum': 0.9, 'weight_decay': 0.0001, 'paramwise_cfg': {'bias_lr_mult': 2, 'bias_decay_mult': 0}}
evaluation = {'interval': 4}
log_config = {'hooks': [{'type': 'MMDetWandbHook', 'by_epoch': True, 'init_kwargs': {'tags': ['backbone:VAN-B0', 'neck:FPN', 'head:PGD', 'pretrained'], 'entity': 'nkoch-aitastic', 'project': 'van-detection3d'}, 'log_checkpoint': True, 'num_eval_images': 100, 'log_checkpoint_metadata': True}, {'type': 'TextLoggerHook', 'by_epoch': True}], 'interval': 50}
pretrained = {'type': 'Pretrained', 'checkpoint': '/home/nils/VAN-Detection/models/van_tiny_754.pth.tar'}
class_names = ['car', 'truck', 'trailer', 'bus', 'construction_vehicle', 'bicycle', 'motorcycle', 'pedestrian', 'traffic_cone', 'barrier']
dist_params = {'backend': 'nccl'}
resume_from = None
dataset_type = 'NuScenesMonoDataset'
img_norm_cfg = {'std': [1, 1, 1], 'mean': [103.53, 116.28, 123.675], 'to_rgb': False}
total_epochs = 12
eval_pipeline = [{'type': 'LoadImageFromFileMono3D'}, {'type': 'DefaultFormatBundle3D', 'with_label': False, 'class_names': ['car', 'truck', 'trailer', 'bus', 'construction_vehicle', 'bicycle', 'motorcycle', 'pedestrian', 'traffic_cone', 'barrier']}, {'keys': ['img'], 'type': 'Collect3D'}]
test_pipeline = [{'type': 'LoadImageFromFileMono3D'}, {'flip': False, 'type': 'MultiScaleFlipAug', 'transforms': [{'type': 'RandomFlip3D'}, {'std': [1, 1, 1], 'mean': [103.53, 116.28, 123.675], 'type': 'Normalize', 'to_rgb': False}, {'type': 'Pad', 'size_divisor': 32}, {'type': 'DefaultFormatBundle3D', 'with_label': False, 'class_names': ['car', 'truck', 'trailer', 'bus', 'construction_vehicle', 'bicycle', 'motorcycle', 'pedestrian', 'traffic_cone', 'barrier']}, {'keys': ['img'], 'type': 'Collect3D'}], 'scale_factor': 1}]
input_modality = {'use_map': False, 'use_lidar': False, 'use_radar': False, 'use_camera': True, 'use_external': False}
train_pipeline = [{'type': 'LoadImageFromFileMono3D'}, {'type': 'LoadAnnotations3D', 'with_bbox': True, 'with_label': True, 'with_bbox_3d': True, 'with_label_3d': True, 'with_attr_label': True, 'with_bbox_depth': True}, {'type': 'Resize', 'img_scale': [(1600, 900)], 'keep_ratio': True}, {'type': 'RandomFlip3D', 'flip_ratio_bev_horizontal': 0.5}, {'std': [1, 1, 1], 'mean': [103.53, 116.28, 123.675], 'type': 'Normalize', 'to_rgb': False}, {'type': 'Pad', 'size_divisor': 32}, {'type': 'DefaultFormatBundle3D', 'class_names': ['car', 'truck', 'trailer', 'bus', 'construction_vehicle', 'bicycle', 'motorcycle', 'pedestrian', 'traffic_cone', 'barrier']}, {'keys': ['img', 'gt_bboxes', 'gt_labels', 'attr_labels', 'gt_bboxes_3d', 'gt_labels_3d', 'centers2d', 'depths'], 'type': 'Collect3D'}]
mp_start_method = 'fork'
optimizer_config = {'grad_clip': {'max_norm': 35, 'norm_type': 2}}
checkpoint_config = {'interval': 4, 'max_keep_ckpts': 3}
opencv_num_threads = 0
